(this["webpackJsonpe621-slideshow"]=this["webpackJsonpe621-slideshow"]||[]).push([[0],{10:function(e,t,n){e.exports={displayContainer:"Display_displayContainer__1y-B5",image:"Display_image__1JJz2",text:"Display_text__1LbkM"}},15:function(e,t,n){e.exports={view:"View_view__2vr6n",hidden:"View_hidden__2bpX_",visible:"View_visible__v_6PK"}},29:function(e,t,n){e.exports={cache:"Cache_cache__Nm8x0"}},30:function(e,t,n){e.exports={manageSetButton:"ManageSetButton_manageSetButton__2Mv6b"}},31:function(e,t,n){e.exports={slideshowContainer:"Slideshow_slideshowContainer__3_r4l"}},36:function(e,t,n){},37:function(e,t,n){},64:function(e,t,n){"use strict";n.r(t);var s=n(1),a=n.n(s),r=n(13),i=n.n(r),c=(n(36),n(37),n(8)),o=function(){return Object(c.b)()},u=c.c,l=n(2);function d(e,t){var n=localStorage.getItem(e);if(null===n)return t;try{return JSON.parse(n)}catch(s){return t}}function f(e,t){try{return localStorage.setItem(e,JSON.stringify(t)),!0}catch(n){return!1}}var p={username:"",api_key:"",image_display_size:"sample",video_display_size:"720p",video_display_type:"mp4"},_=function(){return d("settings.username",p.username)},j=function(){return d("settings.api_key",p.api_key)},h=function(){return d("settings.image_display_size",p.image_display_size)},b=function(e){return f("settings.username",e)},g=function(e){return f("settings.api_key",e)},v=Object(l.c)({name:"settings",initialState:p,reducers:{clear:function(e){b(p.username),g(p.api_key)},setLogin:function(e,t){e.username=t.payload.username,e.api_key=t.payload.apiKey,b(t.payload.username),g(t.payload.apiKey)},setImageDisplaySize:function(e,t){e.image_display_size=t.payload,f("settings.image_display_size",t.payload)},setVideoDisplaySize:function(e,t){e.video_display_size=t.payload,f("settings.video_display_size",t.payload)},setVideoDisplayType:function(e,t){e.video_display_type=t.payload,f("settings.video_display_type",t.payload)}}}),x=v.actions,O=(x.clear,x.setLogin),m=x.setImageDisplaySize,w=(x.setVideoDisplaySize,x.setVideoDisplayType,function(e){return e.settings.username}),y=function(e){return e.settings.image_display_size},S=v.reducer,k=n(6),C=n(27),I=n.n(C),N=n(28),z=n.n(N),D=I.a.create({baseURL:"https://e621.net/"});D.interceptors.request.use((function(e){e.params=Object(k.a)(Object(k.a)({},e.params),{},{_client:"SanguineDerg's Slideshow/1.0 (by SanguineDerg on e621)"});var t=_(),n=j();return""!==t&&""!==n&&(e.auth={username:t,password:n}),e}));var L=z()(D,{maxRPS:1}),P={getPosts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return L.get("posts.json",{params:e})}},M=function(e){switch(e.file.ext){case"jpg":case"png":case"gif":return"image";case"webm":return"video";case"swf":return"flash"}},E=function(e){var t=h(),n=e.file.md5;switch(t){case"full":return"https://static1.e621.net/data/".concat(n.substring(0,2),"/").concat(n.substring(2,4),"/").concat(n,".").concat(e.file.ext);case"sample":return e.sample.has?"https://static1.e621.net/data/sample/".concat(n.substring(0,2),"/").concat(n.substring(2,4),"/").concat(n,".").concat(e.file.ext):"https://static1.e621.net/data/".concat(n.substring(0,2),"/").concat(n.substring(2,4),"/").concat(n,".").concat(e.file.ext)}},B=function(e){switch(M(e)){case"image":return function(e){if(null===e.file.url)return E(e);switch(h()){case"full":return e.file.url;case"sample":return e.sample.url}}(e);case"video":case"flash":return""}},F=P,V=n(4),A=n.n(V),T=n(9),J=n(14),R={getManagedSets:function(){return L.get("post_sets/for_select.json")},getSetById:function(e){return L.get("post_sets/".concat(e,".json"))},addPostToSet:function(e,t){var n=new FormData;return n.append("post_ids[]",e.toString()),L.post("post_sets/".concat(t,"/add_posts.json"),n)},removePostFromSet:function(e,t){var n=new FormData;return n.append("post_ids[]",e.toString()),L.post("post_sets/".concat(t,"/remove_posts.json"),n)}},W=Object(l.b)("sets/fetchManagedSets",Object(T.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.getManagedSets();case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),K=Object(l.b)("sets/fetchWorkingSet",function(){var e=Object(T.a)(A.a.mark((function e(t,n){var s,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(s=H(n.getState()))){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,R.getSetById(s);case 5:return a=e.sent,e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),U=Object(l.b)("sets/addCurrentPostToSet",function(){var e=Object(T.a)(A.a.mark((function e(t,n){var s,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(s=H(n.getState()))){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,R.addPostToSet(t,s);case 5:return a=e.sent,e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),q=Object(l.b)("sets/removeCurrentPostFromSet",function(){var e=Object(T.a)(A.a.mark((function e(t,n){var s,a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(s=H(n.getState()))){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,R.removePostFromSet(t,s);case 5:return a=e.sent,e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),G=Object(l.c)({name:"sets",initialState:{managed_sets:null,working_set_id:null,working_set:null,update_set_status:"idle"},reducers:{setWorkingSetId:function(e,t){e.working_set_id=t.payload,e.working_set=null},resetUpdateSetStatus:function(e){e.update_set_status="idle"}},extraReducers:function(e){e.addCase(W.fulfilled,(function(e,t){e.managed_sets=t.payload})).addCase(W.rejected,(function(e,t){e.managed_sets=null,e.working_set_id=null,e.working_set=null})).addCase(K.fulfilled,(function(e,t){e.working_set=t.payload})).addCase(K.rejected,(function(e,t){e.working_set=null})).addCase(U.pending,(function(e,t){e.update_set_status="working"})).addCase(U.fulfilled,(function(e,t){e.working_set=t.payload,null===t.payload?e.update_set_status="failed":e.update_set_status="added"})).addCase(U.rejected,(function(e,t){e.update_set_status="failed"})).addCase(q.pending,(function(e,t){e.update_set_status="working"})).addCase(q.fulfilled,(function(e,t){e.working_set=t.payload,null===t.payload?e.update_set_status="failed":e.update_set_status="removed"})).addCase(q.rejected,(function(e,t){e.update_set_status="failed"}))}}),X=G.actions,Y=X.setWorkingSetId,Z=X.resetUpdateSetStatus,$=function(e){return e.sets.managed_sets},H=function(e){return e.sets.working_set_id},Q=function(e){return e.sets.working_set},ee=function(e){return e.sets.update_set_status},te=G.reducer,ne=Object(l.b)("posts/fetchPosts",function(){var e=Object(T.a)(A.a.mark((function e(t,n){var s;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.getPosts({tags:oe(n.getState()),page:ue(n.getState())});case 2:return s=e.sent,e.abrupt("return",s.data.posts);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),se=Object(l.c)({name:"posts",initialState:{posts:{},fetch_order:[],fetch_tags:"",fetch_page:1,fetch_status:"idle",fetch_id:"",slideshow_index:0},reducers:{clear:function(e){e.fetch_order=[],e.fetch_tags="",e.fetch_page=1,e.fetch_status="idle",e.fetch_id="",e.slideshow_index=0},startSearch:function(e,t){e.fetch_order=[],e.fetch_tags=t.payload,e.fetch_page=1,e.fetch_status="idle",e.fetch_id="",e.slideshow_index=0},previousSlide:function(e){0!==e.slideshow_index&&(e.slideshow_index-=1)},nextSlide:function(e){e.slideshow_index<e.fetch_order.length-1&&(e.slideshow_index+=1)}},extraReducers:function(e){e.addCase(ne.pending,(function(e,t){e.fetch_status="loading",e.fetch_id=t.meta.requestId})).addCase(ne.fulfilled,(function(e,t){if(t.meta.requestId===e.fetch_id){var n=t.payload;0===n.length?(e.fetch_status="finished",e.fetch_page=0,e.fetch_id=""):(e.fetch_status="idle",e.fetch_page=e.fetch_page&&e.fetch_page+1,e.fetch_id="",n.forEach((function(t){e.posts[t.id]=t,e.fetch_order.push(t.id)})))}}))}}),ae=se.actions,re=(ae.clear,ae.startSearch),ie=ae.previousSlide,ce=ae.nextSlide,oe=function(e){return e.posts.fetch_tags},ue=function(e){return e.posts.fetch_page},le=function(e){return e.posts.fetch_order},de=function(e){return e.posts.posts},fe=function(e){return e.posts.slideshow_index},pe=Object(J.a)([fe,le],(function(e,t){return Array.from({length:6},(function(t,n){return n+e-2})).filter((function(e){return e>=0&&e<t.length}))})),_e=Object(J.a)([de,le,fe],(function(e,t,n){return 0===t.length?null:e[t[n]]})),je=Object(J.a)([_e],(function(e){return null!==e?e.id:null})),he=Object(J.a)([je,Q],(function(e,t){return null!==e&&null!==t&&t.post_ids.includes(e)})),be=Object(J.a)([de,le,pe],(function(e,t,n){return 0===t.length?[]:n.map((function(n){return e[t[n]]}))})),ge=function(){return function(e,t){"idle"===t().posts.fetch_status&&e(ne())}},ve=se.reducer,xe=n(29),Oe=n.n(xe),me=n(0);function we(){var e=u(be);return Object(me.jsx)("div",{className:Oe.a.cache,children:e.map((function(e){return"image"===M(e)&&Object(me.jsx)("img",{src:B(e),alt:""},e.id)}))})}var ye=n(5),Se=Object(l.c)({name:"view",initialState:{screen:"search"},reducers:{switchScreen:function(e,t){e.screen=t.payload}}}),ke=Se.actions.switchScreen,Ce=function(e){return e.view.screen},Ie=Se.reducer;function Ne(){var e=Object(s.useState)(""),t=Object(ye.a)(e,2),n=t[0],a=t[1],r=o();return Object(me.jsxs)("div",{children:[Object(me.jsx)("input",{value:n,onChange:function(e){return a(e.target.value)},type:"text"}),Object(me.jsx)("br",{}),Object(me.jsx)("button",{onClick:function(){r(function(e){return function(t,n){t(re(e)),t(ne()),t(Z())}}(n)),r(ke("slideshow"))},children:"Search"}),Object(me.jsx)("br",{}),Object(me.jsx)("button",{onClick:function(){r(ke("slideshow"))},children:"Close"}),Object(me.jsx)("br",{}),Object(me.jsx)("button",{onClick:function(){r(ke("settings"))},children:"Settings"})]})}function ze(){var e=Object(s.useState)(""),t=Object(ye.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)(""),i=Object(ye.a)(r,2),c=i[0],l=i[1],d=u(w),f=u(y),p=u($),_=u(H),j=o();return Object(me.jsxs)("div",{children:[Object(me.jsx)("span",{children:""!==d?"Logged in as ".concat(d):"Not logged in"}),Object(me.jsx)("br",{}),Object(me.jsx)("input",{value:n,onChange:function(e){return a(e.target.value)},type:"text"}),Object(me.jsx)("br",{}),Object(me.jsx)("input",{value:c,onChange:function(e){return l(e.target.value)},type:"password"}),Object(me.jsx)("br",{}),Object(me.jsx)("button",{onClick:function(){j(O({username:n,apiKey:c}))},children:"Save Login"}),Object(me.jsx)("hr",{}),Object(me.jsxs)("select",{value:f,onChange:function(e){return j(m(e.target.value))},children:[Object(me.jsx)("option",{value:"full",children:"Full Image"}),Object(me.jsx)("option",{value:"sample",children:"Sample Image"})]}),Object(me.jsx)("hr",{}),Object(me.jsx)("button",{onClick:function(){return j(W())},children:"Get sets"}),Object(me.jsx)("br",{}),null!==p&&Object(me.jsxs)(me.Fragment,{children:[Object(me.jsxs)("select",{value:null!==_?_:void 0,onChange:function(e){return j(Y(""!==e.target.value?parseInt(e.target.value):null))},children:[Object(me.jsx)("option",{children:"Select a set"}),Object(me.jsx)("optgroup",{label:"Owned",children:p.Owned.map((function(e,t){var n=Object(ye.a)(e,2),s=n[0],a=n[1];return Object(me.jsx)("option",{value:a,children:s},t)}))}),Object(me.jsx)("optgroup",{label:"Owned",children:p.Maintained.map((function(e,t){var n=Object(ye.a)(e,2),s=n[0],a=n[1];return Object(me.jsx)("option",{value:a,children:s},t)}))})]}),Object(me.jsx)("hr",{})]}),Object(me.jsx)("button",{onClick:function(){j(K()),j(ke("search"))},children:"Close"})]})}var De=n(10),Le=n.n(De);function Pe(){var e=Object(c.c)(_e),t=null!==e?M(e):null;return Object(me.jsxs)("div",{className:Le.a.displayContainer,children:["image"===t&&Object(me.jsx)("img",{className:Le.a.image,src:null!==e?B(e):void 0,alt:""}),"video"===t&&Object(me.jsx)("div",{className:Le.a.text,children:Object(me.jsx)("span",{children:"Video"})}),"flash"===t&&Object(me.jsx)("div",{className:Le.a.text,children:Object(me.jsx)("span",{children:"Flash"})})]})}var Me=n(7),Ee=n.n(Me),Be=n(30),Fe=n.n(Be);function Ve(){var e=u(ee),t=u(je),n=u(he),a=u(Q),r=Object(s.useState)("\ud83d\uddd1\ufe0f"),i=Object(ye.a)(r,2),c=i[0],l=i[1],d=Object(s.useState)(null),f=Object(ye.a)(d,2),p=f[0],_=f[1],j=o();Object(s.useEffect)((function(){var t=function(){null!==p&&(clearTimeout(p),_(null))};switch(e){case"idle":case"added":case"removed":t(),l(n?"\u2796":"\u2795");break;case"working":t(),l("\ud83d\udd04");break;case"failed":t(),l("\u274c"),_(setTimeout((function(){l(n?"\u2796":"\u2795")}),2e3))}}),[e,n]);var h=Object(s.useCallback)((function(){null===t||"working"===e||n||j(U(t))}),[j,t,e,n]),b=Object(s.useCallback)((function(){null!==t&&"working"!==e&&n&&j(q(t))}),[j,t,e,n]),g=Object(s.useCallback)((function(e){if(!e.repeat)switch(e.key){case"ArrowUp":return void h();case"ArrowDown":return void b();default:return}}),[h,b]);if(Object(s.useEffect)((function(){return window.addEventListener("keydown",g,!0),function(){return window.removeEventListener("keydown",g,!0)}}),[g]),null===t||null===a)return null;return Object(me.jsx)("button",{className:Fe.a.manageSetButton,onClick:function(){"working"!==e&&j(n?q(t):U(t))},children:c})}function Ae(){var e=o(),t=u(_e),n=Object(s.useCallback)((function(){e((function(e,t){e(ce()),e(Z()),fe(t())>=le(t()).length-5&&e(ge())}))}),[e]),a=Object(s.useCallback)((function(){e((function(e,t){e(ie()),e(Z()),fe(t())>=le(t()).length-5&&e(ge())}))}),[e]),r=Object(s.useCallback)((function(e){if(!e.repeat)switch(e.key){case"ArrowLeft":return void a();case"ArrowRight":return void n();default:return}}),[n,a]);return Object(s.useEffect)((function(){return window.addEventListener("keydown",r,!0),function(){return window.removeEventListener("keydown",r,!0)}}),[r]),Object(me.jsxs)("div",{className:Ee.a.interfaceContainer,children:[Object(me.jsxs)("div",{className:Ee.a.mainControls,children:[Object(me.jsx)("div",{className:Ee.a.nextSlide,onClick:n,children:"Next"}),Object(me.jsx)("div",{className:Ee.a.previousSlide,onClick:a,children:"Previous"}),Object(me.jsx)("div",{className:Ee.a.exitSlideshow,onClick:function(){return e(ke("search"))},children:"Close"}),Object(me.jsx)("a",Object(k.a)(Object(k.a)({className:Ee.a.viewSource,target:"_blank",rel:"noopener noreferrer"},null===t?{onClick:function(){}}:{href:"https://e621.net/posts/".concat(t.id)}),{},{children:"Link"}))]}),Object(me.jsx)("div",{className:Ee.a.extraControls,children:Object(me.jsx)(Ve,{})})]})}var Te=n(31),Je=n.n(Te);function Re(){return Object(me.jsxs)("div",{className:Je.a.slideshowContainer,children:[Object(me.jsx)(Pe,{}),Object(me.jsx)(Ae,{})]})}var We=n(15),Ke=n.n(We);function Ue(e){var t=e.visible,n=void 0===t||t,s=e.disabled,a=void 0!==s&&s,r=e.children;return Object(me.jsx)("div",{className:Ke.a.view+" "+(n?Ke.a.visible:Ke.a.hidden),children:!a&&r})}var qe=function(){var e=u(Ce);return Object(me.jsxs)("div",{className:"App",children:[Object(me.jsx)(we,{}),Object(me.jsx)(Ue,{disabled:"slideshow"!==e,children:Object(me.jsx)(Re,{})}),Object(me.jsx)(Ue,{visible:"search"===e,children:Object(me.jsx)(Ne,{})}),Object(me.jsx)(Ue,{visible:"settings"===e,children:Object(me.jsx)(ze,{})})]})},Ge=Object(l.a)({reducer:{posts:ve,view:Ie,settings:S,sets:te},preloadedState:{settings:{username:_(),api_key:j(),image_display_size:h(),video_display_size:d("settings.video_display_size",p.video_display_size),video_display_type:d("settings.video_display_type",p.video_display_type)}}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Ge.dispatch(W()),i.a.render(Object(me.jsx)(a.a.StrictMode,{children:Object(me.jsx)(c.a,{store:Ge,children:Object(me.jsx)(qe,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,n){e.exports={interfaceContainer:"Interface_interfaceContainer__32rjR",mainControls:"Interface_mainControls__1f-3y",extraControls:"Interface_extraControls__3sxVc",fadeout:"Interface_fadeout__3FYND",nextSlide:"Interface_nextSlide__1oMMA",previousSlide:"Interface_previousSlide__1G1Z_",exitSlideshow:"Interface_exitSlideshow__1-rsM",viewSource:"Interface_viewSource__1ikEu"}}},[[64,1,2]]]);
//# sourceMappingURL=main.f8afb543.chunk.js.map